<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Happy Birthday Annie</title>

<style>
html, body {
  margin: 0;
  padding: 0;
  width: 100%;
  height: 100%;
  background: #ffd7e8;
  overflow: hidden;
  font-family: "comic sans ms", cursive;
}

/* overlay */
#overlay {
  position: fixed;
  inset: 0;
  background: rgba(255, 215, 232, 0.95);
  display: none;
  justify-content: center;
  align-items: center;
  z-index: 999;
}

/* game box */
#game {
  position: relative;
  width: 520px;
  height: 360px;
  background: #ffb6d9;
  border-radius: 18px;
  box-shadow: 0 0 30px rgba(0,0,0,0.2);
}

/* exit */
#exit {
  position: absolute;
  top: 8px;
  right: 12px;
  font-size: 22px;
  cursor: pointer;
  color: white;
}

/* cat */
#cat {
  position: absolute;
  left: 40px;
  bottom: 40px;
  width: 180px;
}

/* cake */
#cake {
  position: absolute;
  right: 110px;
  bottom: 80px;
  width: 90px;
  cursor: pointer;
}

/* knife */
#knife {
  position: absolute;
  right: 40px;
  bottom: 80px;
  width: 60px;
  cursor: pointer;
}

/* dragging */
.dragging {
  pointer-events: none;
}
</style>
</head>

<body>

<!-- floating image trigger -->
<img src="pic2.png" id="trigger" style="position:absolute;left:20%;top:30%;width:90px;cursor:pointer">

<!-- game overlay -->
<div id="overlay">
  <div id="game">
    <div id="exit">âœ•</div>

    <img id="cat" src="cat_standing.png">
    <img id="cake" src="cake_full.png">
    <img id="knife" src="knife.png">
  </div>
</div>

<audio id="ribbonSound" src="ribbon.mp3"></audio>
<audio id="eatSound" src="doorwow.mp3"></audio>

<script>
const overlay = document.getElementById("overlay");
const trigger = document.getElementById("trigger");
const exitBtn = document.getElementById("exit");

const knife = document.getElementById("knife");
const cake = document.getElementById("cake");
const cat = document.getElementById("cat");

let holdingKnife = false;
let cakeSliced = false;
let holdingCake = false;
let stage = 0;

const stages = [
  "cat_eating.png",
  "cat_fat1_standing.png",
  "cat_fat1_eating.png",
  "cat_fat2_standing.png",
  "cat_fat2_eating.png",
  "cat_fat3_standing.png",
  "cat_fat3_eating.png",
  "cat_done.png"
];

/* open game */
trigger.onclick = () => {
  overlay.style.display = "flex";
};

/* exit */
exitBtn.onclick = () => closeGame();

function closeGame() {
  overlay.style.display = "none";
  resetGame();
}

/* knife logic */
knife.addEventListener("click", e => {
  holdingKnife = true;
  knife.style.opacity = 0.6;
  e.stopPropagation();
});

/* right click puts knife down */
document.addEventListener("contextmenu", e => {
  if (holdingKnife) {
    e.preventDefault();
    holdingKnife = false;
    knife.style.opacity = 1;
  }
});

/* cake click (slice only if knife held) */
cake.addEventListener("click", e => {
  if (!cakeSliced && holdingKnife) {
    cakeSliced = true;
    holdingKnife = false;
    cake.src = "cake_slice.png";
    knife.style.opacity = 1;
  }
  e.stopPropagation();
});

/* drag cake only after sliced */
cake.addEventListener("mousedown", e => {
  if (!cakeSliced) return;
  holdingCake = true;
  cake.classList.add("dragging");
});

document.addEventListener("mousemove", e => {
  if (!holdingCake) return;
  cake.style.left = e.clientX - 40 + "px";
  cake.style.top = e.clientY - 40 + "px";
});

document.addEventListener("mouseup", e => {
  if (!holdingCake) return;
  holdingCake = false;
  cake.classList.remove("dragging");

  const catBox = cat.getBoundingClientRect();
  const cakeBox = cake.getBoundingClientRect();

  const overlap =
    cakeBox.left < catBox.right &&
    cakeBox.right > catBox.left &&
    cakeBox.top < catBox.bottom &&
    cakeBox.bottom > catBox.top;

  if (overlap) advanceCat();
});

/* cat progression */
function advanceCat() {
  if (stage >= stages.length) return;

  cat.src = stages[stage];
  document.getElementById("eatSound").play();
  stage++;

  if (stage === stages.length) {
    cat.onclick = closeGame;
  }
}

/* reset */
function resetGame() {
  holdingKnife = false;
  cakeSliced = false;
  holdingCake = false;
  stage = 0;

  cat.src = "cat_standing.png";
  cake.src = "cake_full.png";
  knife.style.opacity = 1;

  cake.style.right = "110px";
  cake.style.bottom = "80px";
}
</script>

</body>
</html>
