<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>happy birthday annie</title>

<style>
html,body{
  margin:0;padding:0;width:100%;height:100%;
  background:#ffd7e8;overflow:hidden;
  font-family:"Comic Sans MS",cursive;
}
#app{width:100%;height:100%;position:relative}

/* slides */
.slide{position:absolute;inset:0;display:none;justify-content:center;align-items:center}
.slide img{max-width:70%;max-height:70%}

/* bow */
#bow{
  position:absolute;top:50%;left:50%;
  transform:translate(-50%,-50%);
  display:none;gap:8px;z-index:5
}
#bow img{width:160px;transition:.6s}
#bow img:first-child{margin-right:-6px}
#bow img:last-child{margin-left:-6px}
#bow.untie img:first-child{transform:translateX(-220px) rotate(-20deg);opacity:0}
#bow.untie img:last-child{transform:translateX(220px) rotate(20deg);opacity:0}

/* door */
#door{
  position:absolute;top:50%;left:50%;
  transform:translate(-50%,-50%);
  display:none;max-width:300px;z-index:4
}

/* main */
#main{display:none;width:100%;height:100%;position:relative}
#title{
  position:absolute;top:8%;left:50%;
  transform:translateX(-50%);
  font-size:3em;color:white;
  text-shadow:2px 2px 6px #ff9ed9
}

/* floating images */
.float{
  position:absolute;width:90px;
  animation:float 4s ease-in-out infinite alternate;
  cursor:grab;user-select:none
}
@keyframes float{from{transform:translateY(0)}to{transform:translateY(-25px)}}

/* overlays */
.overlay{
  display:none;
  position:fixed;inset:0;
  background:rgba(255,215,232,.92);
  z-index:999;
  justify-content:center;
  align-items:center
}
.overlayContent{
  position:relative;
  max-width:90vw;
  max-height:85vh;
}
.closeBtn{
  position:absolute;
  top:-10px;right:-10px;
  background:#ff9ed9;
  color:white;
  width:32px;height:32px;
  border-radius:50%;
  text-align:center;
  line-height:32px;
  font-size:20px;
  cursor:pointer;
}

/* letter */
.letterFinal{transform:translateY(-24%)}

/* feeding game (UNCHANGED LOGIC) */
#game{
  width:520px;height:360px;
  background:#ffb6d9;border-radius:14px
}
#cat{position:absolute;left:40px;bottom:40px;width:180px}
#cake{position:absolute;right:110px;bottom:80px;width:90px}
#knife{position:absolute;right:40px;bottom:80px;width:60px}
#slice{position:absolute;width:90px;display:none;pointer-events:none}

/* maze */
#mazeBox{
  width:520px;height:520px;
  background:#ffc4df;border-radius:16px;position:relative
}
.wall{position:absolute;background:#ff8fc7}
#player{position:absolute;width:36px;height:36px}
#goal{
  position:absolute;width:40px;height:40px;
  background:#fff;border-radius:50%;
  right:20px;bottom:20px
}
#mazeVideo{display:none;position:absolute;inset:0;background:black}
#mazeVideo video{width:100%;height:100%;object-fit:cover}

/* gallery */
.polaroid{
  position:absolute;
  background:white;
  padding:8px 8px 20px 8px;
  box-shadow:0 6px 12px rgba(0,0,0,.15);
  animation:drift 12s ease-in-out infinite alternate;
}
.polaroid img{width:160px;height:auto;display:block}
@keyframes drift{
  from{transform:translate(0,0)}
  to{transform:translate(20px,-20px)}
}
</style>
</head>

<body>
<div id="app"></div>

<audio id="ribbonSound" src="ribbon.mp3"></audio>
<audio id="doorSound" src="doorwow.mp3"></audio>

<!-- FEEDING GAME -->
<div id="feedOverlay" class="overlay">
  <div id="game" class="overlayContent">
    <div class="closeBtn" id="feedExit">✕</div>
    <img id="cat" src="cat_standing.png">
    <img id="cake" src="cake_full.png">
    <img id="knife" src="knife.png">
    <img id="slice" src="cake_slice.png">
  </div>
</div>

<!-- LETTER -->
<div id="letterOverlay" class="overlay">
  <div class="overlayContent">
    <div class="closeBtn" id="letterExit">✕</div>
    <img id="letterImg">
  </div>
</div>

<!-- MAZE -->
<div id="mazeOverlay" class="overlay">
  <div id="mazeBox" class="overlayContent">
    <div class="closeBtn" id="mazeExit">✕</div>
    <img id="player" src="maze.PNG">
    <div id="goal"></div>
    <div class="wall" style="left:0;top:0;width:100%;height:20px"></div>
    <div class="wall" style="left:0;top:0;width:20px;height:100%"></div>
    <div class="wall" style="right:0;top:0;width:20px;height:100%"></div>
    <div class="wall" style="left:0;bottom:0;width:100%;height:20px"></div>
    <div class="wall" style="left:80px;top:60px;width:20px;height:360px"></div>
    <div class="wall" style="left:160px;top:0;width:20px;height:300px"></div>
    <div class="wall" style="left:240px;top:140px;width:20px;height:380px"></div>
    <div class="wall" style="left:320px;top:0;width:20px;height:260px"></div>
    <div id="mazeVideo"><video src="AbsoluteCinema2.mp4"></video></div>
  </div>
</div>

<!-- GALLERY -->
<div id="galleryOverlay" class="overlay">
  <div class="overlayContent">
    <div class="closeBtn" id="galleryExit">✕</div>
  </div>
</div>

<!-- SPOTIFY -->
<div id="spotifyOverlay" class="overlay">
  <div class="overlayContent">
    <div class="closeBtn" id="spotifyExit">✕</div>
    <iframe style="border-radius:12px"
      src="https://open.spotify.com/embed/playlist/0zxE4sI9k9ldR12Q4fImLc"
      width="380" height="380" frameborder="0" allow="autoplay; clipboard-write; encrypted-media"></iframe>
  </div>
</div>

<script>
/* ---------- BASE + FLOATING ---------- */
const app=document.getElementById("app");
const slides=["slide1.png","slide2.png","slide3.png","slide4.png","slide5.png"];
let slideIndex=0;

slides.forEach((src,i)=>{
  const d=document.createElement("div");
  d.className="slide";
  if(i===0)d.style.display="flex";
  d.innerHTML=`<img src="${src}">`;
  app.appendChild(d);
});
const slideEls=document.querySelectorAll(".slide");

const bow=document.createElement("div");
bow.id="bow";
bow.innerHTML=`<img src="bowleft.png"><img src="bowright.png">`;
app.appendChild(bow);

const door=document.createElement("img");
door.id="door";
door.src="doorclosed.png";
app.appendChild(door);

const main=document.createElement("div");
main.id="main";
main.innerHTML=`<div id="title"></div>`;
app.appendChild(main);

function makeDraggable(el){
  let d=false,ox=0,oy=0;
  el.addEventListener("mousedown",e=>{
    d=true;ox=e.clientX-el.offsetLeft;oy=e.clientY-el.offsetTop;
    e.stopPropagation();
  });
  document.addEventListener("mousemove",e=>{
    if(!d)return;
    el.style.left=e.clientX-ox+"px";
    el.style.top=e.clientY-oy+"px";
  });
  document.addEventListener("mouseup",()=>d=false);
}

const pics=[
"pic2.png","pic3.png","pic4.png","pic5.png","pic6.png","pic7.png","pic8.png","pic9.png","pic10.png",
"pic11.png","pic12.png","pic13.png","pic14.png","pic15.png","pic16.png","pic18.png","pic19.png","pic20.png",
"pic21.png","pic22.png","pic23.png","pic24.png","pic25.png","pic26.png","pic28.png","pic29.png","pic30.png",
"pic31.png","pic32.png","pic33.png","pic34.png","pic35.png","pic36.png","pic38.png","pic39.png","pic40.png",
"pic41.png","pic42.png","pic43.png","pic44.png","pic45.png"
];

let pic2,pic3,pic11,pic32,pic41;

pics.forEach(src=>{
  const img=document.createElement("img");
  img.src=src;img.className="float";
  img.style.left=Math.random()*85+"%";
  img.style.top=Math.random()*75+"%";
  main.appendChild(img);
  makeDraggable(img);
  if(src==="pic2.png")pic2=img;
  if(src==="pic3.png")pic3=img;
  if(src==="pic11.png")pic11=img;
  if(src==="pic32.png")pic32=img;
  if(src==="pic41.png")pic41=img;
});

/* ---------- FLOW ---------- */
let mainShown=false;
document.body.onclick=()=>{
  if(mainShown)return;
  if(slideIndex<slides.length-1){
    slideEls[slideIndex++].style.display="none";
    slideEls[slideIndex].style.display="flex";
    return;
  }
  slideEls[slideIndex].style.display="none";
  bow.style.display="flex";
  door.style.display="block";
};

bow.onclick=e=>{
  e.stopPropagation();ribbonSound.play();
  bow.classList.add("untie");
  setTimeout(()=>bow.style.display="none",700);
};
door.onclick=e=>{
  e.stopPropagation();doorSound.play();
  door.src="dooropen.png";
  setTimeout(()=>{
    door.style.display="none";
    main.style.display="block";
    mainShown=true;
    typewriter();
  },1000);
};

function typewriter(){
  const t=document.getElementById("title");
  const text="Happy Birthday Annie";
  let i=0,dir=1;
  setInterval(()=>{
    i+=dir;
    t.textContent=text.slice(0,i);
    if(i===text.length||i===0)dir*=-1;
  },150);
}

/* ---------- LETTER (UNCHANGED) ---------- */
const letterOverlay=document.getElementById("letterOverlay");
const letterImg=document.getElementById("letterImg");
const letterExit=document.getElementById("letterExit");
const letterFrames=[
"bunny_letter1.png","bunny_letter2.png","bunny_letter3.png",
"bunny_letter4.png","bunny_letter5.png","bunny_letter6.png"
];
let letterTimer=null;

pic41.onclick=e=>{
  e.stopPropagation();
  letterOverlay.style.display="flex";
  let i=0;
  letterImg.classList.remove("letterFinal");
  letterImg.src=letterFrames[0];
  letterTimer=setInterval(()=>{
    i++;
    if(i>=letterFrames.length){
      clearInterval(letterTimer);
      letterTimer=null;
      letterImg.classList.add("letterFinal");
      return;
    }
    letterImg.src=letterFrames[i];
  },1000);
};
letterExit.onclick=()=>{
  letterOverlay.style.display="none";
  letterImg.classList.remove("letterFinal");
  if(letterTimer)clearInterval(letterTimer);
};

/* ---------- FEEDING GAME (VERBATIM LOGIC) ---------- */
const feedOverlay=document.getElementById("feedOverlay");
const feedExit=document.getElementById("feedExit");
const cat=document.getElementById("cat");
const cake=document.getElementById("cake");
const knife=document.getElementById("knife");
const slice=document.getElementById("slice");
const game=document.getElementById("game");

const frames=[
"cat_standing.png","cat_eating.png",
"cat_fat1_standing.png","cat_fat1_eating.png",
"cat_fat2_standing.png","cat_fat2_eating.png",
"cat_fat3_standing.png","cat_fat3_eating.png",
"cat_done.png"
];
let stage=0,holdingKnife=false,holdingSlice=false,eatingTimer=null;

pic2.onclick=e=>{
  e.stopPropagation();
  feedOverlay.style.display="flex";
};

feedExit.onclick=()=>{
  feedOverlay.style.display="none";
  resetGame();
};

function resetGame(){
  stage=0;
  cat.src=frames[0];
  holdingKnife=false;
  holdingSlice=false;
  slice.style.display="none";
  if(eatingTimer){clearTimeout(eatingTimer);eatingTimer=null;}
}

function toGame(e){
  const r=game.getBoundingClientRect();
  return {x:e.clientX-r.left,y:e.clientY-r.top};
}

knife.addEventListener("mousedown",e=>{
  const p=toGame(e);
  holdingKnife=true;
  knife.style.pointerEvents="none";
  knife.style.left=p.x-knife.width/2+"px";
  knife.style.top=p.y-knife.height/2+"px";
  e.stopPropagation();
});

feedOverlay.addEventListener("mousemove",e=>{
  const p=toGame(e);
  if(holdingKnife){
    knife.style.left=p.x-knife.width/2+"px";
    knife.style.top=p.y-knife.height/2+"px";
  }
  if(holdingSlice){
    slice.style.left=p.x-slice.width/2+"px";
    slice.style.top=p.y-slice.height/2+"px";
  }
});

cake.onclick=e=>{
  if(!holdingKnife)return;
  const p=toGame(e);
  holdingKnife=false;
  holdingSlice=true;
  knife.style.pointerEvents="auto";
  slice.style.display="block";
  slice.style.left=p.x-slice.width/2+"px";
  slice.style.top=p.y-slice.height/2+"px";
};

feedOverlay.addEventListener("mouseup",()=>{
  if(!holdingSlice)return;
  const a=slice.getBoundingClientRect();
  const b=cat.getBoundingClientRect();
  if(!(a.right<b.left||a.left>b.right||a.bottom<b.top||a.top>b.bottom)){
    holdingSlice=false;
    slice.style.display="none";
    stage++;
    cat.src=frames[stage];
    eatingTimer=setTimeout(()=>{
      stage++;
      cat.src=frames[stage];
    },1500);
  }
});

cat.onclick=()=>{
  if(frames[stage]==="cat_done.png"){
    feedOverlay.style.display="none";
    resetGame();
  }
};

/* ---------- MAZE ---------- */
const mazeOverlay=document.getElementById("mazeOverlay");
const mazeExit=document.getElementById("mazeExit");
const player=document.getElementById("player");
const goal=document.getElementById("goal");
const walls=[...document.querySelectorAll(".wall")];
const videoBox=document.getElementById("mazeVideo");
const video=videoBox.querySelector("video");

pic3.onclick=e=>{
  e.stopPropagation();
  mazeOverlay.style.display="flex";
  player.style.left="30px";
  player.style.top="30px";
};

mazeExit.onclick=()=>{
  mazeOverlay.style.display="none";
  video.pause();video.currentTime=0;
  videoBox.style.display="none";
};

function collide(a,b){
  return !(a.right<b.left||a.left>b.right||a.bottom<b.top||a.top>b.bottom);
}

document.addEventListener("keydown",e=>{
  if(mazeOverlay.style.display!=="flex")return;
  let dx=0,dy=0;
  if(e.key==="ArrowUp"||e.key==="w")dy=-6;
  if(e.key==="ArrowDown"||e.key==="s")dy=6;
  if(e.key==="ArrowLeft"||e.key==="a")dx=-6;
  if(e.key==="ArrowRight"||e.key==="d")dx=6;
  if(!dx&&!dy)return;

  const prev={x:player.offsetLeft,y:player.offsetTop};
  player.style.left=prev.x+dx+"px";
  player.style.top=prev.y+dy+"px";

  const pr=player.getBoundingClientRect();
  for(const w of walls){
    if(collide(pr,w.getBoundingClientRect())){
      player.style.left=prev.x+"px";
      player.style.top=prev.y+"px";
      return;
    }
  }
  if(collide(pr,goal.getBoundingClientRect())){
    videoBox.style.display="block";
    video.play();
    video.onended=()=>mazeExit.click();
  }
});

/* ---------- GALLERY ---------- */
const galleryOverlay=document.getElementById("galleryOverlay");
const galleryExit=document.getElementById("galleryExit");
pic32.onclick=e=>{
  e.stopPropagation();
  galleryOverlay.style.display="flex";
  const box=galleryOverlay.querySelector(".overlayContent");
  box.querySelectorAll(".polaroid").forEach(p=>p.remove());
  document.querySelectorAll("img[src^='us_']").forEach((img,i)=>{
    const p=document.createElement("div");
    p.className="polaroid";
    p.style.left=Math.random()*60+"%";
    p.style.top=Math.random()*60+"%";
    p.style.transform=`rotate(${Math.random()*10-5}deg)`;
    const clone=img.cloneNode();
    p.appendChild(clone);
    box.appendChild(p);
    makeDraggable(p);
  });
};
galleryExit.onclick=()=>galleryOverlay.style.display="none";

/* ---------- SPOTIFY ---------- */
const spotifyOverlay=document.getElementById("spotifyOverlay");
const spotifyExit=document.getElementById("spotifyExit");
pic11.onclick=e=>{
  e.stopPropagation();
  spotifyOverlay.style.display="flex";
};
spotifyExit.onclick=()=>spotifyOverlay.style.display="none";
</script>
</body>
</html>
